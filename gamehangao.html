<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VinWonders</title>
    <link rel="icon" type="image/png" href="./assets/iconlogo.png" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
      integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer" />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Open Sans", sans-serif;
      }
      body {
        font-family: "Poppins", sans-serif;
        margin: 0;
        padding: 20px;
        background: #f3f4f6;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        box-sizing: border-box;
        overflow-x: hidden;
      }

      h1 {
        text-align: center;
        margin-bottom: 30px;
      }

      .gameao-head {
        width: 800px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .gameao-head i {
        color: #ff6600;
        font-size: 20px;
        padding: 6px;
      }

      .game-list {
        display: grid;
        grid-template-columns: repeat(
          auto-fit,
          minmax(250px, 1fr)
        ); /* ✅ tự co giãn */
        gap: 20px;
        width: 100%;
        max-width: 900px; /* ✅ giới hạn độ rộng */
        box-sizing: border-box;
      }

      .game-card {
        background: #fff;
        border-radius: 16px;
        overflow: hidden;
        transition: transform 0.2s;
        width: 100%;
        box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
      }

      .game-card:hover {
        transform: translateY(-5px);
      }

      .game-card img {
        width: 100%;
        height: 180px;
        object-fit: cover;
      }

      .game-info {
        padding: 15px;
      }

      .game-info h3 {
        margin: 0 0 10px;
        font-size: 18px;
        color: #222;
      }

      .game-info p {
        margin: 2px 0 6px;
        font-size: 16px;
        color: #222;
      }

      .join-btn {
        background: #ff6600;
        color: #fff;
        border: none;
        padding: 10px 20px;
        border-radius: 10px;
        cursor: pointer;
        transition: 0.2s;
        margin-top: 10px;
        width: 100%;
        font-size: 14px;
      }

      .join-btn:hover {
        background: #e55c00;
      }

      /* ===== Modal ===== */
      .modal {
        display: none;
        position: fixed;
        z-index: 10;
        inset: 0; /* ✅ gọn hơn left/top/width/height */
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
        padding: 10px;
        box-sizing: border-box;
      }

      .modal-content {
        background: #fff;
        padding: 25px;
        border-radius: 16px;
        width: 100%;
        max-width: 400px;
        text-align: center;
        position: relative;
        max-height: 90vh;
        overflow-y: auto;
        box-sizing: border-box;
      }

      .close {
        position: absolute;
        top: 10px;
        right: 15px;
        font-size: 22px;
        cursor: pointer;
      }

      .time-buttons {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin: 15px 0;
        flex-wrap: wrap; /* ✅ tránh tràn ngang */
      }

      .time-btn {
        border: 1px solid #ccc;
        background: white;
        padding: 8px 16px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
      }

      .time-btn.active {
        background: #ff6600;
        color: white;
        border-color: #ff6600;
      }

      .count-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
        margin: 15px 0;
        flex-wrap: wrap; /* ✅ responsive */
      }

      .count-btn {
        background: #ff6600;
        border: none;
        color: white;
        font-size: 20px;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        cursor: pointer;
      }

      .total {
        font-weight: 600;
        margin-top: 10px;
        font-size: 16px;
      }

      .confirm-btn {
        background: #ff6600;
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 8px;
        cursor: pointer;
        width: 100%;
        font-size: 16px;
        font-weight: 600;
        margin-top: 15px;
      }

      .confirm-btn:hover {
        background: #e55c00;
      }

      .invoice {
        text-align: left;
      }

      .barcode {
        width: 100%;
        height: 60px;
        background: repeating-linear-gradient(
          90deg,
          #000 0,
          #000 2px,
          #fff 2px,
          #fff 4px
        );
        margin-top: 10px;
      }

      .player-input {
        margin-bottom: 8px;
        display: flex;
        flex-direction: column;
        text-align: left;
      }

      .player-input label {
        font-size: 14px;
        margin-bottom: 4px;
      }

      .player-input input {
        padding: 6px;
        border-radius: 6px;
        border: 1px solid #ccc;
        width: 100%;
        box-sizing: border-box;
      }

      /* ✅ Responsive mobile tối ưu */
      @media (max-width: 480px) {
        body {
          padding: 10px;
        }
        .game-card img {
          height: 150px;
        }
        .modal-content {
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="gameao-head">
      <a href="./index.html">
        <i class="fa-solid fa-arrow-left"></i>
      </a>
      <h3>Danh sách trò chơi</h3>
      <div></div>
    </div>
    <div class="game-list" id="gameList"></div>

    <!-- Modal đặt vé -->
    <div class="modal" id="bookingModal">
      <div class="modal-content">
        <span class="close" id="closeBooking">&times;</span>
        <img
          id="modalImg"
          src=""
          width="100%"
          height="150"
          style="border-radius: 8px; object-fit: cover" />
        <h3 id="modalTitle"></h3>
        <p id="modalDesc"></p>

        <div>
          <label><b>Chọn khung giờ</b></label>
          <div class="time-buttons">
            <button class="time-btn active" data-time="9:30">9:30</button>
            <button class="time-btn" data-time="11:00">11:00</button>
            <button class="time-btn" data-time="14:00">14:00</button>
          </div>
        </div>

        <div>
          <label><b>Số lượng người chơi</b></label>
          <div class="count-wrapper">
            <button class="count-btn" id="minusBtn">−</button>
            <span id="playerCount">1</span>
            <button class="count-btn" id="plusBtn">+</button>
          </div>
        </div>

        <!-- Danh sách nhập tên người chơi -->
        <div id="playerNames"></div>

        <p class="total">Tổng tiền: <span id="totalPrice">100.000</span> đ</p>
        <button class="confirm-btn" id="confirmBooking">Xác nhận đặt vé</button>
      </div>
    </div>

    <!-- Modal hóa đơn -->
    <div class="modal" id="invoiceModal">
      <div class="modal-content invoice">
        <span class="close" id="closeInvoice">&times;</span>
        <h2>Hóa đơn trò chơi</h2>
        <p><b>Tên trò chơi:</b> <span id="invoiceName"></span></p>
        <p><b>Khung giờ:</b> <span id="invoiceTime"></span></p>
        <p><b>Số lượng người chơi:</b> <span id="invoiceCount"></span></p>
        <p><b>Tổng tiền:</b> <span id="invoiceTotal"></span> đ</p>
        <p><b>Số thứ tự:</b> <span id="invoiceOrder"></span></p>
        <div id="playerList"></div>
        <div class="barcode"></div>
      </div>
    </div>

    <script>
      const PRICE_PER_PLAYER = 100000;
      const MAX_PLAYERS = 7;
      const games = [
        {
          id: 1,
          name: "Tàu lượn siêu tốc",
          time: "09:00 - 10:00",
          desc: "Trải nghiệm cảm giác mạnh với đường ray uốn lượn",
          img: "./assets/hammo.webp",
        },
        {
          id: 2,
          name: "Vòng quay mặt trời",
          time: "15:00 - 16:30",
          desc: "Ngắm toàn cảnh công viên từ trên cao.",
          img: "./assets/slider2.jpg",
        },
        {
          id: 3,
          name: "Thế giới nước",
          time: "18:30 - 20:00",
          desc: "Thỏa sức vùng vẫy trong không gian mát lạnh.",
          img: "./assets/slider8.jpg",
        },
      ];

      const gameList = document.getElementById("gameList");
      const bookingModal = document.getElementById("bookingModal");
      const invoiceModal = document.getElementById("invoiceModal");
      const closeBooking = document.getElementById("closeBooking");
      const closeInvoice = document.getElementById("closeInvoice");
      const modalImg = document.getElementById("modalImg");
      const modalTitle = document.getElementById("modalTitle");
      const modalDesc = document.getElementById("modalDesc");
      const minusBtn = document.getElementById("minusBtn");
      const plusBtn = document.getElementById("plusBtn");
      const playerCount = document.getElementById("playerCount");
      const totalPrice = document.getElementById("totalPrice");
      const confirmBooking = document.getElementById("confirmBooking");
      const invoiceName = document.getElementById("invoiceName");
      const invoiceTime = document.getElementById("invoiceTime");
      const invoiceCount = document.getElementById("invoiceCount");
      const invoiceOrder = document.getElementById("invoiceOrder");
      const invoiceTotal = document.getElementById("invoiceTotal");
      const playerNames = document.getElementById("playerNames");
      const playerList = document.getElementById("playerList");

      gameList.innerHTML = games
        .map(
          (g) => `
      <div class="game-card">
        <img src="${g.img}" alt="${g.name}" />
        <div class="game-info">
          <h3>${g.name}</h3>
          <p>${g.desc}</p>
          <p>${g.time}</p>
          <button class="join-btn" data-id="${g.id}">Tham gia hàng ảo</button>
        </div>
      </div>
    `
        )
        .join("");

      let currentGame = null;
      let selectedTime = "9:30";
      let count = 1;

      const renderPlayerInputs = () => {
        playerNames.innerHTML = "";
        for (let i = 1; i <= count; i++) {
          playerNames.innerHTML += `
          <div class="player-input">
            <label>Tên người chơi ${i}:</label>
            <input type="text" id="playerName${i}" placeholder="Nhập tên người chơi ${i}">
          </div>
        `;
        }
      };

      document.querySelectorAll(".join-btn").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          const id = e.target.dataset.id;
          currentGame = games.find((g) => g.id == id);
          modalImg.src = currentGame.img;
          modalTitle.textContent = currentGame.name;
          modalDesc.textContent = currentGame.desc;
          count = 1;
          playerCount.textContent = count;
          totalPrice.textContent = PRICE_PER_PLAYER.toLocaleString();
          renderPlayerInputs();
          bookingModal.style.display = "flex";
        });
      });

      document.querySelectorAll(".time-btn").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          document
            .querySelectorAll(".time-btn")
            .forEach((b) => b.classList.remove("active"));
          e.target.classList.add("active");
          selectedTime = e.target.dataset.time;
        });
      });

      plusBtn.onclick = () => {
        if (count < MAX_PLAYERS) {
          count++;
          playerCount.textContent = count;
          totalPrice.textContent = (count * PRICE_PER_PLAYER).toLocaleString();
          renderPlayerInputs();
        } else {
          alert("Giới hạn tối đa là 7 người chơi!");
        }
      };

      minusBtn.onclick = () => {
        if (count > 1) {
          count--;
          playerCount.textContent = count;
          totalPrice.textContent = (count * PRICE_PER_PLAYER).toLocaleString();
          renderPlayerInputs();
        }
      };

      confirmBooking.onclick = () => {
        const order = Math.floor(Math.random() * 3) + 50;
        invoiceName.textContent = currentGame.name;
        invoiceTime.textContent = selectedTime;
        invoiceCount.textContent = count;
        invoiceTotal.textContent = (count * PRICE_PER_PLAYER).toLocaleString();
        invoiceOrder.textContent = order;

        // Lấy danh sách tên người chơi
        let playersHTML = "<b>Danh sách người chơi:</b><ol>";
        for (let i = 1; i <= count; i++) {
          const name =
            document.getElementById(`playerName${i}`).value.trim() ||
            `Người chơi ${i}`;
          playersHTML += `<li>${name}</li>`;
        }
        playersHTML += "</ol>";
        playerList.innerHTML = playersHTML;

        bookingModal.style.display = "none";
        invoiceModal.style.display = "flex";
      };

      closeBooking.onclick = () => (bookingModal.style.display = "none");
      closeInvoice.onclick = () => (invoiceModal.style.display = "none");
    </script>
  </body>
</html>
